<html>
  <head>
    <title>appengine.datastore.entities API reference (Clojure for Google App Engine)</title>
    <link href="static/favicon.png" rel="icon" />
    <link href="static/favicon.png" rel="shortcut icon" />
    <link media="all" type="text/css" href="static/clojure.css" rel="stylesheet" />
    <link media="all" type="text/css" href="static/wiki.css" rel="stylesheet" />
    <link media="all" type="text/css" href="static/internal.css" rel="stylesheet" />
    <!-- TODO: are we using these (from clojure.org)? If so, add the files -->
    <script src="file/view/code_highlighter.js" type="text/javascript"></script>
    <script src="file/view/clojure.js" type="text/javascript"></script>
    <style>.menuWrapper{height: 36px;}</style>
    <!--[if lte IE 6]>
    <link rel="stylesheet" href="http://www.wikispaces.com/_/2009051601/s/internal_ie.css" type="text/css" />
    <![endif]-->
  </head>
<!--
This document was auto-generated from the source by the clojure autodoc system.
To report errors or ask questions about the overall documentation structure, formatting,
etc., contact Tom Faulhaber (google mail name: tomfaulhaber).
For errors in the documentation of a particular namespace, contact the author of that
namespace.
-->
  <body>
    <div id="AllContentContainer">
      <div id="Header">
	<a id="Logo" href="index.html"><img alt="Clojure" height="100" width="100" src="static/appengine-100x100.png" /></a>
	<h1><a title="page header title" id="page-header" href="index.html">Clojure for Google App Engine</a></h1>
      </div>
      <div id="leftcolumn"><div style="text-align: center;"></div>
<div class="menu">
  <div class="WikiCustomNav WikiElement wiki">
    <a class="wiki_link" href="index.html">Overview</a><br />
    <a class="wiki_link" href="api-index.html">API Index</a><br />
    <a class="wiki_link" href="#">Namespaces:</a>
    <ul id="left-sidebar-list">
      <li><a href="appengine.datastore.entities-api.html" class="wiki_link">appengine.datastore.entities</a></li><li><a href="appengine.datastore.keys-api.html" class="wiki_link">appengine.datastore.keys</a></li><li><a href="appengine.datastore.protocols-api.html" class="wiki_link">appengine.datastore.protocols</a></li><li><a href="appengine.datastore.query-api.html" class="wiki_link">appengine.datastore.query</a></li><li><a href="appengine.datastore.service-api.html" class="wiki_link">appengine.datastore.service</a></li><li><a href="appengine.datastore.transactions-api.html" class="wiki_link">appengine.datastore.transactions</a></li><li><a href="appengine.datastore.types-api.html" class="wiki_link">appengine.datastore.types</a></li><li><a href="appengine.datastore.utils-api.html" class="wiki_link">appengine.datastore.utils</a></li><li><a href="appengine.environment-api.html" class="wiki_link">appengine.environment</a></li><li><a href="appengine.memcache-api.html" class="wiki_link">appengine.memcache</a></li><li><a href="appengine.server-api.html" class="wiki_link">appengine.server</a></li><li><a href="appengine.taskqueue-api.html" class="wiki_link">appengine.taskqueue</a></li><li><a href="appengine.test-api.html" class="wiki_link">appengine.test</a></li><li><a href="appengine.urlfetch-api.html" class="wiki_link">appengine.urlfetch</a></li><li><a href="appengine.users-api.html" class="wiki_link">appengine.users</a></li><li><a href="appengine.utils-api.html" class="wiki_link">appengine.utils</a></li>
    </ul>
  </div>
</div>
</div>
      <div id="rightcolumn">
	<div id="Content">
	  <div class="contentBox"><div class="innerContentBox">
              <div id="content_view" class="wiki wikiPage">
                <div id="right-sidebar"><div id="toc">
  <h1 class="nopad">Table of Contents</h1>
  <div style="margin-left: 1em;" class="toc-section">
    <a href="#toc0">Overview</a>
    <div style="margin-left: 1em;" class="toc-entry">
      <a href="#appengine.datastore.entities/defentity">defentity</a>
    </div><div style="margin-left: 1em;" class="toc-entry">
      <a href="#appengine.datastore.entities/deserialize-entity">deserialize-entity</a>
    </div><div style="margin-left: 1em;" class="toc-entry">
      <a href="#appengine.datastore.entities/deserialize-property">deserialize-property</a>
    </div><div style="margin-left: 1em;" class="toc-entry">
      <a href="#appengine.datastore.entities/entity-kind-name">entity-kind-name</a>
    </div><div style="margin-left: 1em;" class="toc-entry">
      <a href="#appengine.datastore.entities/entity-protocol-name">entity-protocol-name</a>
    </div><div style="margin-left: 1em;" class="toc-entry">
      <a href="#appengine.datastore.entities/entity?">entity?</a>
    </div><div style="margin-left: 1em;" class="toc-entry">
      <a href="#appengine.datastore.entities/extract-key">extract-key</a>
    </div><div style="margin-left: 1em;" class="toc-entry">
      <a href="#appengine.datastore.entities/make-blank-entity">make-blank-entity</a>
    </div><div style="margin-left: 1em;" class="toc-entry">
      <a href="#appengine.datastore.entities/serialize-entity">serialize-entity</a>
    </div><div style="margin-left: 1em;" class="toc-entry">
      <a href="#appengine.datastore.entities/serialize-property">serialize-property</a>
    </div>
    <br />
  </div>
</div>
</div>
                <div id="content-tag"><h1 id="overview">API for <span id="namespace-name">appengine.datastore.entities</span></h1>
by <span id="author">Roman Scherer</span><br />
<br />Usage:
<pre>
(ns your-namespace
  (:require <span id="long-name">appengine.datastore.entities</span>))
</pre><pre>
</pre><h2>Overview</h2>
<pre id="namespace-docstr">Entity is the fundamental unit of data storage. It has an
immutable identifier (contained in the Key) object, a reference to an
optional parent Entity, a kind (represented as an arbitrary string),
and a set of zero or more typed properties.</pre>
<br />
<h2>Public Variables and Functions</h2>
<div id="var-entry">
  <br />
  <hr />
  <h2 id="appengine.datastore.entities/defentity">defentity</h2>
  <span id="var-type">macro</span><br />
  <pre id="var-usage">Usage: (defentity entity [parent] property-specs)
</pre>
  <pre id="var-docstr">A macro to define entitiy records.

Examples:

  (defentity Continent ()
    ((iso-3166-alpha-2 :key lower-case :serialize lower-case)
     (location :serialize GeoPt)
     (name)))
  ; =&gt; (user.Continent)

  (continent {:name "Europe" :iso-3166-alpha-2 "eu"})
  ; =&gt; #:user.Continent{:key #&lt;Key user.Continent("eu")&gt;, :kind "user.Continent",
                        :iso-3166-alpha-2 "eu", :location nil, :name "Europe"}

  (defentity Country (Continent)
    ((iso-3166-alpha-2 :key lower-case :serialize lower-case)
     (location :serialize GeoPt)
     (name)))

  (country (continent {:iso-3166-alpha-2 "eu" :name "Europe"})
           {:iso-3166-alpha-2 "de" :name "Germany"})
  ; =&gt; #:user.Country{:key #&lt;Key continent("eu")/country("de")&gt;, :kind country,
                      :iso-3166-alpha-2 de, :location nil, :name Germany}</pre>
  
</div><div id="var-entry">
  <br />
  <hr />
  <h2 id="appengine.datastore.entities/deserialize-entity">deserialize-entity</h2>
  <span id="var-type">multimethod</span><br />
  <pre id="var-usage">No usage documentation available</pre>
  <pre id="var-docstr">Convert a Entity into a persistent map. The property values are
stored under their property names converted to a keywords, the
entity's key and kind under the :key and :kind keys.

Examples:

  (deserialize-entity (Entity. "continent"))
  ; =&gt; {:kind "continent", :key #&lt;Key continent(no-id-yet)&gt;}

  (deserialize-entity (doto (Entity. "continent")
                     (.setProperty "name" "Europe")))
  ; =&gt; {:name "Europe", :kind "continent", :key #&lt;Key continent(no-id-yet)&gt;}</pre>
  
</div><div id="var-entry">
  <br />
  <hr />
  <h2 id="appengine.datastore.entities/deserialize-property">deserialize-property</h2>
  <span id="var-type">function</span><br />
  <pre id="var-usage">Usage: (deserialize-property value deserializer)
</pre>
  <pre id="var-docstr">Deserialize the property value with the deserializer.</pre>
  
</div><div id="var-entry">
  <br />
  <hr />
  <h2 id="appengine.datastore.entities/entity-kind-name">entity-kind-name</h2>
  <span id="var-type">function</span><br />
  <pre id="var-usage">Usage: (entity-kind-name record)
</pre>
  <pre id="var-docstr">Returns the kind of the entity as a string.

Examples:

  (entity-kind-name 'Continent)
  ; =&gt; "continent"

  (entity-kind-name 'CountryFlag)
  ; =&gt; "country-flag"</pre>
  
</div><div id="var-entry">
  <br />
  <hr />
  <h2 id="appengine.datastore.entities/entity-protocol-name">entity-protocol-name</h2>
  <span id="var-type">function</span><br />
  <pre id="var-usage">Usage: (entity-protocol-name entity)
</pre>
  <pre id="var-docstr">Returns the protocol name for an entity. Entity can be a class,
a symbol or a string. If the entity is blank the fn returns nil.

Examples:

  (entity-protocol-name nil)
  ; =&gt; nil

  (entity-protocol-name "")
  ; =&gt; nil

  (entity-protocol-name Continent)
  ; =&gt; "ContinentProtocol"

  (entity-protocol-name 'Continent)
  ; =&gt; "ContinentProtocol"

  (entity-protocol-name "Continent")
  ; =&gt; "ContinentProtocol"</pre>
  
</div><div id="var-entry">
  <br />
  <hr />
  <h2 id="appengine.datastore.entities/entity?">entity?</h2>
  <span id="var-type">function</span><br />
  <pre id="var-usage">Usage: (entity? arg)
</pre>
  <pre id="var-docstr">Returns true if arg is an Entity, false otherwise.</pre>
  
</div><div id="var-entry">
  <br />
  <hr />
  <h2 id="appengine.datastore.entities/extract-key">extract-key</h2>
  <span id="var-type">function</span><br />
  <pre id="var-usage">Usage: (extract-key record key-fns &amp; {:keys [separator]})
</pre>
  <pre id="var-docstr">Extract the entity key from record. The key-fns argument must be a
sequence of key/fn pairs. The key is used to extract the value, and fn
will be applied to the value if it is not nil. If fn is true, the
value is returned without transformation. The values will be joined by
"-" or the separator specified. The fn returns the entity key only
if all key values are present in the record.

Examples:

  (extract-key {:iso-3166-alpha-2 "eu" :name "Europe"}
               [[:iso-3166-alpha-2 true] [:name lower-case]])
  ; =&gt; "eu-europe"

  (extract-key {:iso-3166-alpha-2 "eu"}
               [[:iso-3166-alpha-2 true] [:name lower-case]])
  ; =&gt; nil</pre>
  
</div><div id="var-entry">
  <br />
  <hr />
  <h2 id="appengine.datastore.entities/make-blank-entity">make-blank-entity</h2>
  <span id="var-type">function</span><br />
  <pre id="var-usage">Usage: (make-blank-entity key-or-kind)
       (make-blank-entity parent kind key-or-id)
</pre>
  <pre id="var-docstr">Returns a blank Entity. If called with one parameter, key-or-kind
  must be either a Key or a String, that specifies the kind of the
  entity. If called with multiple parameters, parent must be the Key
  of the parent entity, kind a String that specifies the kind of the
  entity and key-name a String that identifies the entity.

Examples:

  (make-blank-entity "continent")
  ; =&gt; #&lt;Entity [continent(no-id-yet)]&gt;

  (make-blank-entity (make-key "continent" "eu"))
  ; =&gt; #&lt;Entity [continent("eu")]&gt;</pre>
  
</div><div id="var-entry">
  <br />
  <hr />
  <h2 id="appengine.datastore.entities/serialize-entity">serialize-entity</h2>
  <span id="var-type">multimethod</span><br />
  <pre id="var-usage">No usage documentation available</pre>
  <pre id="var-docstr">Converts a map into an entity. The kind of the entity is determined
by one of the :key or the :kind keys, which must be in the map.

Examples:

  (serialize-entity {:kind "person" :name "Bob"})
  ; =&gt; #&lt;Entity &lt;Entity [person(no-id-yet)]:
  ;        name = Bob

  (serialize-entity {:key (make-key "continent" "eu") :name "Europe"})
  ; =&gt; #&lt;Entity &lt;Entity [continent("eu")]:
  ;        name = Europe</pre>
  
</div><div id="var-entry">
  <br />
  <hr />
  <h2 id="appengine.datastore.entities/serialize-property">serialize-property</h2>
  <span id="var-type">function</span><br />
  <pre id="var-usage">Usage: (serialize-property value serializer)
</pre>
  <pre id="var-docstr">Serialize the property value with the serializer.</pre>
  
</div>


</div>
              </div>
            </div>
          </div>
	</div>
	<div id="foot">
	  <div style="text-align: center;" id="copyright">Copyright (c) 2009, 2010 John D. Hume, Roman Scherer, Jean-Denis Greze, E.Fukamachi</div>
	</div>
      </div>
      <div id="DesignedBy">Logo &amp; site design by <a title="Visit Tom Hickey's website." href="http://www.tomhickey.com">Tom Hickey</a>.<br />
      Clojure auto-documentation system by Tom Faulhaber.</div>
    </div>
    <!-- /AllContentContainer -->
  </body>

</html>